<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>カフェ予約管理</title>
  <style>
    body { font-family: 'sans-serif'; }
    h1 { color: #4a4a4a; }
    form, table { margin: 20px 0; }
    input, select { padding: 4px 8px; margin: 5px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f5f5f5; }
  </style>
</head>
<body>
  <h1>カフェ予約登録</h1>
  <form id="resForm">
    <label>
      日付:
      <input type="date" id="date" required>
    </label>
    <label>
      時間帯:
      <select id="time" required>
        <option value="">選択してください</option>
        <option value="11:00">11:00～</option>
        <option value="13:00">13:00～</option>
      </select>
    </label>
    <label>
      名前（カタカナ）:
      <input type="text" id="name" pattern="^[ァ-ヴー]+$" required placeholder="例：カトウ">
    </label>
    <label>
      電話番号:
      <input type="tel" id="tel" pattern="^[0-9\-]+$" required placeholder="例：090-1234-5678">
    </label>
    <button type="submit">予約登録</button>
  </form>

  <h2>予約一覧</h2>
  <table id="list">
    <thead>
      <tr>
        <th>日付</th>
        <th>時間帯</th>
        <th>名前</th>
        <th>電話番号</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>

  <script>
    // データ保存用（LocalStorage）
    function getReservations() {
      return JSON.parse(localStorage.getItem("reservations") || "[]");
    }
    function saveReservations(res) {
      localStorage.setItem("reservations", JSON.stringify(res));
    }

    function renderList() {
      const resList = getReservations();
      const tbody = document.querySelector("#list tbody");
      tbody.innerHTML = ""; // 一度クリア
      resList.forEach(r => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${r.date}</td>
                        <td>${r.time}</td>
                        <td>${r.name}</td>
                        <td>${r.tel}</td>`;
        tbody.appendChild(tr);
      });
    }

    document.getElementById("resForm").onsubmit = function(e) {
      e.preventDefault();
      const date = document.getElementById("date").value;
      const time = document.getElementById("time").value;
      const name = document.getElementById("name").value.trim();
      const tel = document.getElementById("tel").value.trim();

      // 入力バリデーション
      if (!(/^[ァ-ヴー]+$/.test(name))) {
        alert("名前はカタカナで入力してください");
        return;
      }

      const reservations = getReservations();
      // 保存
      reservations.push({ date, time, name, tel });
      saveReservations(reservations);
      renderList();
      // フォームリセット
      document.getElementById("resForm").reset();
    };

    // 初回表示
    renderList();
  </script>
</body>
</html>
